# 性能管理

> top / sar / free / watch


## 1 监控CPU
查看CPU使用率
```
$sar -u
```

查看CPU平均负载
```
$sar -q 1 2
```
sar指定-q后，就能查看运行队列中的进程数、系统上的进程大小、平均负载等；

## 2 查询内存
查看内存使用状况 sar指定-r之后，可查看内存使用状况;
```
$sar -r 1 2
```
查看内存使用量
```
$free -m
```


## 3 查询页面交换
查看页面交换发生状况 页面发生交换时，服务器的吞吐量会大幅下降；服务器状况不良时，如果怀疑因为内存不足而导致了页面交换的发生，可以使用sar -W这个命令来确认是否发生了大量的交换；
```
$sar -W 1 3
```


6.5. 综合应用
当系统中sar不可用时，可以使用以下工具替代：linux下有 vmstat、Unix系统有prstat

eg： 查看cpu、内存、使用情况： vmstat n m （n 为监控频率、m为监控次数）

[/home/weber#]vmstat 1 3

使用watch 工具监控变化 当需要持续的监控应用的某个数据变化时，watch工具能满足要求； 执行watch命令后，会进入到一个界面，输出当前被监控的数据，一旦数据变化，便会高亮显示变化情况；

eg：操作redis时，监控内存变化：
```
$watch -d -n 1 './redis-cli info | grep memory'
```
以下为watch工具中的界面内容，一旦内存变化，即实时高亮显示变化
